-- Create schema
CREATE SCHEMA "BBP";

-- Create Time Dimension Table with Surrogate Key and Time_id as Primary Key
CREATE TABLE "BBP".dim_time (
    Time_ID INT PRIMARY KEY IDENTITY(1,1),
    Date DATE,
    Year INT,
    Quarter INT,
    Month INT,
    Day INT,
    Hour INT
);

-- Create Weather Dimension Table with Surrogate Key
CREATE TABLE "BBP".dim_weather (
    Weather_ID INT PRIMARY KEY IDENTITY(1,1),
    Weather VARCHAR(50),
    Temperature FLOAT,
    Precipitation FLOAT
);

-- Create Event Dimension Table with Surrogate Key
CREATE TABLE "BBP".dim_event (
    Event_ID INT PRIMARY KEY IDENTITY(1,1),
    Event_Name VARCHAR(50), -- Allowing null values
);

-- Create Fact Table
CREATE TABLE "BBP".fact_pedestrian (
    Pedestrians INT,
    Towards_Manhattan INT,
    Towards_Brooklyn INT,
    Time_ID INT,
    Weather_ID INT,
    Event_ID INT,
    FOREIGN KEY (Time_ID) REFERENCES "BBP".dim_time(Time_ID),
    FOREIGN KEY (Weather_ID) REFERENCES "BBP".dim_weather(Weather_ID),
    FOREIGN KEY (Event_ID) REFERENCES "BBP".dim_event(Event_ID)
);
